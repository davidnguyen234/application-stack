<!doctype html>
<html lang=en>
<head>
<meta charset="UTF-8">
 
<link href="styles.css" rel="stylesheet" type="text/css">

<title>MEVN Stack</title>
</head>
    
<body>
    
<header>
<div id="container">
<a href="index.html"><img style="width: 120px; display: inline; float: left; margin: 10px;" src="images/mevn.png" alt="MEVN Logo"></a>
<h1 class="logo"><a style="margin-left: 10px;" href="index.html">
    Build full stack web apps with MEVN Stack</a></h1>    
</div>
    
<nav id="primary">
    <ul>
    <li><a href="mevn.html">MEVN Tutorial</a></li>
    <li><a href="webapp.html">Web App Tutorial</a></li>
    <li><a href="https://github.com/davidnguyen234/application-stack">GitHub Repo</a></li>
    <li><a href="contactus.html">Contact Us</a></li>
    </ul>
</nav>
</header>    
    
<div id="wrapper">
    

    
<h2 class="m-t-2">Spinning up a MEVN stack on GCP (Google Cloud platform)</h2>
    
<p class="m-t-1">1. Navigate to <a href="https://console.cloud.google.com/">Google Cloud Platform</a> and create a new project.</p>  
<img src="images/1.png" alt="Create a new project on GCP">
    
<p class="m-t-2">2. Select the hamburger menu in the upper left and click on Compute Engine.</p>
<img src="images/2.png" alt="Click Compute Engine">
    
<p class="m-t-2">3. Create a VM instance from scratch.</p>
<p class="l-indent">a. Click on the button ‘create new instance’
<img src="images/3.png" class="m-t-0" alt="Create a new instance"></p>
<p class="l-indent m-t-1">b. Enter a name for the new instance
<img src="images/4.png" class="m-t-0" alt="Name the instance"></p>
<p class="l-indent">c. Select the region closest to you.</p>
<p class="l-indent">d. Under the machine type, select 'f1-micro' in the dropdown list. </p>
<p class="l-indent">e. Check both 'Allow HTTP traffic' and 'Allow HTTPS traffic' below Firewall.
<img src="images/5.png" class="m-t-0" alt="Check all boxes below Firewall"></p>
<p class="l-indent">f. Click on the Create button.</p>
    
<p class="m-t-2">4. The new VM instance should automatically start. If it doesn’t, click on the play button.</p>

<p class="m-t-1">5. We need to allow the ports 5000 and 8080 to be open. We do this by adding the port numbers to the “default-allow-http” firewall rule.</p>
<p class="l-indent">a. Click on the hamburger and click on VPC network</p>
<p class="l-indent">b. Click on Firewall rules
<img style="width: 400px;" class="m-t-0" src="images/30.png" alt="Firewall rules"></p>    
<p class="l-indent">c. Click on default-allow-http and edit</p>
<p class="l-indent">d. Scroll down to Protocols and ports and under Specified protocols and ports enter 5000 and 8080 separated by commas in the tcp field.
<img style="width: 600px;" class="m-t-0" src="images/31.png" alt="Protocols"></p>   
<p class="l-indent">e. Click on save </p>
    
<h4 class="m-t-2">Add Package Manager</h4> 
<p class="m-t-1">6. Click on ssh. This will open up a terminal window.</p>  
<img style="width: 700px;" src="images/6.png" alt="Click on ssh">
<p>First we need to install Node Version Manager (NVM). </p>
<span class="console">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.1/install.sh | bash</span>
    
<h4 class="m-t-2">Adding Node.js</h4> 
    
<p class="m-t-1">7. Installing the latest version of Node.js run the following:</p>
<span class="console">nvm install stable</span>
<p>If you get nvm command not found, you will need to close your terminal and relaunch it. Once your server has restarted, use the command <strong>nvm install stable</strong> to install the latest version of Node.js. </p>
<p class="m-t-1">To verify that NVM has been installed run the following:</p>
<span class="console">nvm  --version</span> 

<p class="m-t-1">8. Install Node by running the following command: </p>
<span class="console">nvm install node</span>
    
<h4 class="m-t-2">Install Vue.js</h4> 
    
<p class="m-t-1">1. Install Vue Cli. Interactive project scaffolding built on Webpack. Run the following code:</p>
<span class="console">npm install -g @vue/cli</span>
    
<p class="m-t-1">2. Initialize the npm by running the following code:</p>
<span class="console">npm init</span>
    
<p class="m-t-1">3. Complete the following prompts on the command line/terminal:</p>
<p class="l-indent">a. Package Name: (enter a name) here we used client. Which was defaulted to the package name field from the directory we made in step 1. (The images in this section use “posts” instead of client, but the process is the same.)  Press enter.
<img style="width: 700px;" class="m-t-0" src="images/20.png" alt="Install Vue"></p>
<p class="l-indent">b. Version: (version number will appear here in parenthesis) Leave the defaulted and press enter. </p>
<p class="l-indent">c. Description: (for example, test), press enter and then you will see this: entry point: (index.js). Press enter.
<img style="width: 400px;" class="m-t-0" src="images/21.png" alt="Install Vue"></p>
<p class="l-indent">d. Test command: You can leave this blank. Press enter.
<img style="width: 400px;" class="m-t-0" src="images/22.png" alt="Install Vue"></p>
<p class="l-indent">e. Git repository: You can leave this blank. Press enter.
<img style="width: 350px;" class="m-t-0" src="images/23.png" alt="Install Vue"></p>
<p class="l-indent">f. Keywords: You can leave this blank. Press enter.</p>
<p class="l-indent">g. Author: (Your Name) Press enter.
<img style="width: 350px;" class="m-t-0" src="images/24.png" alt="Install Vue"></p> 
<p class="l-indent">h. License: (Enter the license you’d like to use. We used MIT here) Press enter.
<img style="width: 350px;" class="m-t-0" src="images/25.png" alt="Install Vue"></p>
<p class="l-indent">i. This is what you will see next. Type 'y' and press enter.
<img style="width: 700px;" class="m-t-0" src="images/26.png" alt="Install Vue"></p>
<p class="m-t-1">4. To intall the package and save it as a dependency in the package.json file, run the following code:</p>
<span class="console">npm install</span>
<p class="m-t-1">5. Next, we need to create a project to do so use the following command: (You may name your project what you’d like, but for this tutorial we named it client.)</p>
<span class="console">vue create client</span>
<p>Next you will see the following:</p>
<img style="width: 400px;" class="m-t-0" src="images/27.png" alt="Install Vue">
<p>Press enter. When it is complete, you will see the following: </p>
<img style="width: 700px;" class="m-t-0" src="images/28.png" alt="Install Vue">
<p>Your project is now created.</p>
<p class="m-t-1">6. In the command line type the next two commands:</p>
<span class="console">cd client</span>
<span class="console">npm run serve</span>
<p>You will see this screen when it is complete:</p>
<img style="width: 400px;" class="m-t-0" src="images/29.png" alt="Install Vue">
<!--
<p class="m-t-1">7. A message will be displayed: <em>Your application is running here: http://localhost:8080</em>. Since this is running on Google Cloud Platform a firewall rule will need to be created.</p>
<p>Select the hamburger menu in the upper left and click on VPC network and select firewall rule.</p>
<p class="l-indent">a. Click on the button Create New Firewall Rule</p>
<p class="l-indent">b. Enter a name for the firewall rule. fwr8080 wood be good</p>
<p class="l-indent">c. In the Source IP ranges field enter 0.0.0.0</p>
<p class="l-indent">d. In the Protocols and ports select the tcp field and enter 8080</p>
<p class="l-indent">e. Click on the Create button</p>
<p class="l-indent">f. Click on the hamburger menu and select Compute Engine</p>
<p class="l-indent">g. The firewall rule now needs to be applied to the VM instance</p>
<p class="l-indent-2">I. You will need to stop the VM instance first</p>
<p class="l-indent-2">II. Click on the name of this instance and click on the edit button</p>
<p class="l-indent-2">III. Scroll down to Network tags and enter the firewall name</p>
<p class="l-indent-2">IV. Click on the Save button at the bottom</p>
<p class="l-indent-2">V. Select the VM instance and click on the play button to spin it back up</p>
<p class="l-indent">h. Click on the ssh button</p>
<p class="l-indent">i. Now we need to edit the path. Run the following: <span class="console m-t-0">cd posts/client/config/</span></p>
<p class="l-indent">j. The index.js file needs to be updated. Run the following code: <span class="console m-t-0">nano index.js</span></p>
<p class="l-indent">k. Use the arrow keys and move the cursor down to 
    <span class="console m-t-0">// Various Dev Server settings <br> host: 'localhost', // can be overwritten by process.env.HOST</span>
The host needs to be changed to 0.0.0.0. Update the host and close and save. Control + c to save y for yes then press enter.</p>
-->
<p class="m-t-1">7. Restart the VM instance.</p>
<p class="m-t-1">8. Click on ssh.</p>
<!--
<p class="m-t-1">9. Run the following to start the web dev server: 
    <span class="console m-t-0">cd posts/client/</span>
    <span class="console m-t-0">npm run dev</span></p>
-->
<p class="m-t-1">9. Now that we have the frontend time to build out the backend with Express.
Run the following in the root directory(client):
    <span class="console m-t-0">mkdir server</span>
    <span class="console m-t-0">cd server</span></p>
<p class="m-t-1">10. Initialize this server project with npm and this will create a package.json inside the server directory. Run the following: <span class="console m-t-0">npm init -f </span></p>
<p class="m-t-1">11. The package.json file is missing the start command so we will need to add this.
Run the following: <span class="console m-t-0">nano package.json </span></p>
<p class="m-t-1">12. With the arrow keys move down to the scripts section and add the following above test <span class="console m-t-0">"start": "node src/app.js", </span> Close and save.</p>
<!--
<p class="m-t-1">13. Create a src folder inside the server directory and a app.js file.
Run the following:
    <span class="console m-t-0">mkdir src</span>
    <span class="console m-t-0">touch app.js</span></p>
-->
    

<h4 class="m-t-2">Adding Express</h4> 
<p class="m-t-1">13. Install Express inside the server directory. Run the following:
    <span class="console m-t-0">npm install express --save</span></p>
<p class="m-t-1">14. We will also need some of the other dependencies for making HTTP requests. So let’s go ahead and install bodyParser, morgan and cors. Run the following:
    <span class="console m-t-0">npm install --save body-parser cors morgan</span></p>
    
<!--<p class="m-t-1">15. Update the app.js in the src directory with the following:</p>
<div style="font-family: Courier; padding-left: 32px;" >
    <p>const express = require('express') <br> 
    const bodyParser = require('body-parser') <br>
    const cors = require('cors') <br> <br>
    const morgan = require('morgan') <br> <br>
    const app = express() <br>
    app.use(morgan('combined')) <br>
    app.use(bodyParser.json()) <br>
    app.use(cors()) </p>

    <p style="margin: 0;"> app.get('/posts', (req, res) => { </p>
    <p class="l-indent" style="margin: 0;">res.send( <br> </p>
    <p class="l-indent-2" style="margin: 0;">[{ title: "Hello World!",
        description: "Hi there! How are you?" }] </p>
    <p class="l-indent" style="margin: 0;">  ) </p>
    <p style="margin: 0;">    })</p>

    <p>app.listen(process.env.PORT || 8081) </p>

 </div>   
-->
    
<!--
<p class="m-t-1">15. So, we don’t need to restart the server every time need to run the following:
    <span class="console m-t-0">npm install --save nodemon</span></p>
    
<p class="m-t-1">16. Update the scripts. </p>
<div style="font-family: Courier; padding-left: 32px;" >
<p style="margin: 0;">"scripts": { <br>
<p class="l-indent-2" style="margin: 0;">"start": "./node_modules/nodemon/bin/nodemon.js src/app.js",</p>
<p class="l-indent-2" style="margin: 0;">"test": "echo \"Error: no test specified\" && exit 1"</p>
}
    </div>
-->
    
<h4 class="m-t-2">Create a Mongo.DB account</h4>
<p class="m-t-1">1. Navigate to <a href="https://cloud.mongodb.com/user#/atlas/login">MongoDB Cloud Platform</a> and create a new account.
<p class="m-t-1">2. Register for a new account.</p>
<img style="width: 500px;" src="images/7.png" alt="Register">
<p class="m-t-1">3. Fill out your information and click continue.</p>
<img style="width: 500px;" src="images/8.png" alt="Register">
    
    
<p class="m-t-1">4. Select Starter Clusters and click Create a Cluster.</p>
<img style="width: 700px;" src="images/9.png" alt="Register">
<p class="m-t-1">Starter clusters include the M0, M2, and M5 cluster tiers. These low-cost clusters are suitable for users who are learning MongoDB or developing small proof-of-concept applications.</p> 
    
<p class="m-t-1">5. Select your preferred Cloud Provider & Region. For this example, we will be using the Google Cloud Platform.</p>
<img style="width: 700px;" src="images/10.png" alt="Register">
    
<p class="m-t-1">6. Select M0 Sandbox for cluster tier.</p>
<img style="width: 700px;" src="images/11.png" alt="Cluster Tier">
<p class="m-t-1">Selecting M0 automatically locks the remaining configuration options. If you cannot select the M0 cluster tier, return to the previous step and select a Cloud Provider & Region that supports M0 Free Tier clusters.</p>
    
<p class="m-t-1">7. Enter a name for your cluster in the Cluster Name field. You can enter any name for your cluster. The cluster name can contain ASCII letters, numbers, and hyphens.</p>
<img style="width: 700px;" src="images/12.png" alt="Cluster Tier">
    
<p class="m-t-1">8. Click Create Cluster to deploy the cluster. Once you deploy your cluster, it can take up to 10 minutes for your cluster to provision and become ready to use. </p>
<img style="width: 700px;" src="images/13.png" alt="Cluster Tier">
    
<h4 class="m-t-2">Whitelist Your Connection IP Address</h4>
<p>An IP address is a unique numeric identifier for a device connecting to a network. In Atlas, you can only connect to a cluster from a trusted IP address. Within Atlas, you can create a list of trusted IP addresses, referred to as a whitelist, that can be used to connect to your cluster and access your data.</p>
    
<p class="m-t-1">1. Open the Connect dialog. From your Clusters view, click the Connect button for your cluster.</p>
<img style="width: 700px;" src="images/14.png" alt="Connect IP">
    
<p class="m-t-1">2. Configure your whitelist entry. In the Whitelist your connection IP address step, click Add Your Current IP Address.</p>
<img style="width: 700px;" src="images/15.png" alt="Connect IP">
    
<p class="m-t-1">3. Click Add IP Address.</p>
<img style="width: 700px;" src="images/16.png" alt="Connect IP">

<h4 class="m-t-2">Create a MongoDB User for Your Cluster</h4>
<p>You must create a MongoDB user to access your cluster. For security purposes, Atlas requires clients to authenticate as MongoDB users to access clusters.</p>
<p>MongoDB users are separate from Atlas users:</p> 
<ul class="l-indent">
<li>MongoDB users can access databases hosted in Atlas.</li> 
<li>Atlas users can log into Atlas but do not have access to MongoDB databases.</li>
    
<p class="m-t-1">1. Open the Connect dialog. From your Clusters view, click the Connect button for your cluster.</p>
<img style="width: 700px;" src="images/17.png" alt="Clusters view">
    
<p class="m-t-1">2. In the Create a MongoDB User step of the dialog, enter a Username and Password for your MongoDB user. You’ll use this username and password combination to access data on your cluster.</p>
<img style="width: 700px;" src="images/18.png" alt="Create MongoDB User">
    
<p class="m-t-1">3. Click Create MongoDB User.</p>
<img style="width: 700px;" src="images/19.png" alt="Create MongoDB User"> 
    
<h4 class="m-t-2">Clone the Repo</h4>
<p>1. Next we installed git:</p>
<span class="console">sudo apt install git</span>    
<p>2. Next we associated our git user.name with this installation: </p> 
<span class="console">git config --global user.name "John Doe"</span>
<p>3. Next we associated our git user.email with this installation: </p> 
<span class="console">git config --global user.email "johndoe@example.com"</span>
<p>4. As a sample, we used git clone to copy/paste a repo in our web space: </p> 
<span class="console">sudo git clone (Gene’s repo link goes here)</span>
<p>5. We were able to view the web page here: <em>http://34.82.73.108/todo-list/</em></p>


</ul>   
    
    
    
    
    
<footer>
    <ul>
    <li>Copyright 2019 &copy;</li>
    <li>All Rights Reserved</li>
    <li><a href="reference.html">Reference</a></li>
    </ul>
</footer>   
    
</div>
    
 
    
</body>
</html>